module Test where

import Daml.Script
import Employees
import PartiesSetUp

test: Script ()
test = script do

    testParties@TestParties{applicant, oldEmployee, employer} <- setupParties
    application <- setupApplication applicant employer
    oldEmployeeAccount <- setupEmployeeAccount oldEmployee employer

    application <- submit employer do
        exerciseCmd application MakeAnOffer with salary=100.0

    application <- submit applicant do
        exerciseCmd application CounterOfferApplicant with salary=120.00

    application <- submit applicant do
        exerciseCmd application AcceptOfferApplicant

    employeeAccount <- submit employer do
        exerciseCmd application ReviewApplication

    submitMustFail employer do
        exerciseCmd employeeAccount ReviewVacationRequest

    employeeAccount <- submit applicant do
        exerciseCmd employeeAccount RequestVacation

    employeeAccount <- submit employer do
        exerciseCmd employeeAccount ReviewVacationRequest
        
    return ()