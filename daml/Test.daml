module Test where

import Daml.Script
import Main

test: Script ()
test = script do

    applicant <- allocateParty "Alice"
    employer <- allocateParty "Boss"

    application <- submit applicant do
        createCmd NewEmployeeApplication with
            newApplicant = applicant
            employer = employer
            positionName = "SWE"
            salary = 0.0
            applicantInformation = PersonalInformation with
                name = "Alice"
                lastName = "Smith"
                education = "Master"
            acceptedOfferApplicant = False
            acceptedOfferEmployer = False

    application <- submit employer do
        exerciseCmd application MakeAnOffer with salary=100.0

    application <- submit applicant do
        exerciseCmd application CounterOfferApplicant with salary=120.00

    application <- submit applicant do
        exerciseCmd application AcceptOfferApplicant

    employeeAccount <- submit employer do
        exerciseCmd application ReviewApplication

    submitMustFail employer do
        exerciseCmd employeeAccount ReviewVacationRequest

    employeeAccount <- submit applicant do
        exerciseCmd employeeAccount RequestVacation

    employeeAccount <- submit employer do
        exerciseCmd employeeAccount ReviewVacationRequest
        
    return ()